on:
  schedule:
    - cron: "0 0 * * 0" # Weekly, on Sunday's
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
        with:
          persist-credentials: false

      # - name: Check for Updates
      # run: |
      # VERSION=sed -n 's/^VERSION="\([^"]*\)".*/\1/p' ./update.sh

      - name: Auto Update
        id: autoupdate
        run: bash ./update.sh

      - name: Create Release
        uses: ncipollo/release-action@v1
        with:
          artifacts: "dist/*"
          token: ${{ secrets.GITHUB_TOKEN }}
          body: |
            Auto Update to v${{ steps.autoupdate.outputs.version }}
